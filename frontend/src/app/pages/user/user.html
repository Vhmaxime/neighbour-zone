@if (user(); as user) {
<section class="bg-white rounded-xl shadow-sm border border-gray-100 p-8">
  <div class="flex items-start gap-6">
    <div
      class="w-20 h-20 rounded-full bg-linear-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white text-2xl font-semibold shadow-md flex-shrink-0"
    >
      {{ user.username.charAt(0).toUpperCase() }}
    </div>

    <div class="flex-1 min-w-0">
      <div class="flex items-start justify-between gap-4 mb-1.5">
        <h1 class="text-2xl font-semibold text-gray-900">{{ user.username }}</h1>
        <app-friend-button [friendId]="user.id" />
      </div>
      @if (user.bio) {
      <p class="text-gray-600 text-base leading-relaxed mb-4">{{ user.bio }}</p>
      }

      <!-- Counts -->
      <div class="flex gap-8 mt-5">
        <div class="flex flex-col items-center">
          <span class="text-xl font-semibold text-gray-900">{{ posts()?.count }}</span>
          <span class="text-sm text-gray-500 mt-0.5">Posts</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="text-xl font-semibold text-gray-900">{{ events()?.count }}</span>
          <span class="text-sm text-gray-500 mt-0.5">Events</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="text-xl font-semibold text-gray-900">{{ marketplaceItems()?.count }}</span>
          <span class="text-sm text-gray-500 mt-0.5">Marketplace</span>
        </div>
      </div>
    </div>
  </div>
</section>
} @if (posts() || events()) {
<div class="mt-8 lg:hidden">
  <section class="mb-8">
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Events</h2>
    <div class="overflow-x-auto -mx-4 px-4">
      <div class="flex gap-4 pb-4 min-w-min">
        @for (event of events()?.events; track event.id) {
        <div class="shrink-0 w-80">
          <app-event-tile [event]="event" />
        </div>
        } @empty {
        <p class="text-gray-500 py-12 w-full text-center">No events</p>
        }
      </div>
    </div>
  </section>

  <section>
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Marketplace</h2>
    <div class="overflow-x-auto -mx-4 px-4">
      <div class="flex gap-4 pb-4 min-w-min">
        @for (item of marketplaceItems()?.marketplace; track item.id) {
        <div class="shrink-0 w-80">
          <app-marketplace-tile [item]="item" />
        </div>
        } @empty {
        <p class="text-gray-500 py-12 w-full text-center">No marketplace items</p>
        }
      </div>
    </div>
  </section>

  <section>
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Posts</h2>
    @for (post of posts()?.posts; track post.id) {
    <app-post-tile [post]="post" />
    } @empty {
    <p class="text-gray-500 text-center py-12">No posts</p>
    }
  </section>
</div>

<div class="hidden lg:flex lg:gap-6 mt-8">
  <section class="lg:w-1/2">
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Posts</h2>
    @for (post of posts()?.posts; track post.id) {
    <app-post-tile [post]="post" />
    } @empty {
    <p class="text-gray-500 text-center py-12">No posts</p>
    }
  </section>
  <section class="lg:w-1/3">
    <h2 class="text-xl font-semibold text-gray-900">Events</h2>
    <div class="flex flex-col gap-4 mt-4">
      @for (event of events()?.events; track event.id) {
      <app-event-tile [event]="event" />
      } @empty {
      <p class="text-gray-500 text-center py-12">No events</p>
      }
    </div>
  </section>
  <section class="lg:w-1/3">
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Marketplace</h2>
    <div class="grid grid-cols-1 gap-4">
      @for (item of marketplaceItems()?.marketplace; track item.id) {
      <app-marketplace-tile [item]="item" />
      } @empty {
      <p class="text-gray-500 text-center py-12">No marketplace items</p>
      }
    </div>
  </section>
</div>
}@else{
<div class="flex items-center justify-center gap-2 py-12">
  <span
    class="animate-spin inline-block w-5 h-5 border-2 border-transparent border-t-gray-600 rounded-full"
  ></span
  >Loading...
</div>
}
