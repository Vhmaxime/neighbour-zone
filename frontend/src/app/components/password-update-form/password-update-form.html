<form class="space-y-6 w-full" [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
  @if (isSuccess()) {
    <div
      class="col-span-1 md:col-span-2 p-4 mb-4 text-green-800 bg-green-100 border border-green-200 rounded-lg"
    >
      Password updated successfully!
    </div>
  }
  @if (error()) {
    <div
      class="col-span-1 md:col-span-2 p-4 mb-4 text-red-800 bg-red-100 border border-red-200 rounded-lg"
    >
      {{ error() }}
    </div>
  }

  <div class="flex flex-col mb-4">
    <label
      class="text-sm font-medium text-gray-700 mb-1 [.invalid]:text-red-500!"
      [class.invalid]="
        passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched
      "
      for="currentPassword"
      >Current Password</label
    >
    <input
      id="currentPassword"
      type="password"
      formControlName="currentPassword"
      [class.invalid]="
        passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched
      "
      class="border [.invalid]:border-red-500! [.invalid]:ring-red-500! [.invalid]:text-red-500! border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    @if (
      passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched
    ) {
      @if (passwordForm.get('currentPassword')?.errors?.['required']) {
        <span class="text-red-500 text-sm">required</span>
      }
    }
  </div>

  <div class="flex flex-col mb-4">
    <label
      class="text-sm font-medium text-gray-700 mb-1 [.invalid]:text-red-500!"
      [class.invalid]="
        passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched
      "
      for="newPassword"
      >New Password</label
    >
    <input
      id="newPassword"
      type="password"
      formControlName="newPassword"
      [class.invalid]="
        passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched
      "
      class="border [.invalid]:border-red-500! [.invalid]:ring-red-500! [.invalid]:text-red-500! border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    @if (passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched) {
      @if (passwordForm.get('newPassword')?.errors?.['required']) {
        <span class="text-red-500 text-sm">required</span>
      } @else if (passwordForm.get('newPassword')?.errors?.['minlength']) {
        <span class="text-red-500 text-sm">minimal 8 characters</span>
      } @else if (passwordForm.get('newPassword')?.errors?.['maxlength']) {
        <span class="text-red-500 text-sm">maximal 32 characters</span>
      }
    }
  </div>

  <ul class="[&>li]:text-sm space-y-1 text-(--text-sec)/60">
    <li [class.valid]="hasMinLength()" class="[.valid]:text-green-500">At least 8 characters</li>
    <li [class.valid]="hasUppercase()" class="[.valid]:text-green-500">1 uppercase letter (A–Z)</li>
    <li [class.valid]="hasLowercase()" class="[.valid]:text-green-500">1 lowercase letter (a–z)</li>
    <li [class.valid]="hasNumber()" class="[.valid]:text-green-500">1 number (0–9)</li>
    <li [class.valid]="hasSpecial()" class="[.valid]:text-green-500">
      1 special character (!@#$%^&*)
    </li>
  </ul>

  <div class="flex flex-col mb-4">
    <label
      class="text-sm font-medium text-gray-700 mb-1 [.invalid]:text-red-500!"
      [class.invalid]="
        passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched
      "
      for="confirmPassword"
      >Confirm Password</label
    >
    <input
      id="confirmPassword"
      type="password"
      formControlName="confirmPassword"
      [class.invalid]="
        passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched
      "
      class="border [.invalid]:border-red-500! [.invalid]:ring-red-500! [.invalid]:text-red-500! border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    @if (
      passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched
    ) {
      @if (passwordForm.get('confirmPassword')?.errors?.['required']) {
        <span class="text-red-500 text-sm">required</span>
      } @else if (
        passwordForm.get('confirmPassword')?.value !== passwordForm.get('newPassword')?.value
      ) {
        <span class="text-red-500 text-sm">passwords do not match</span>
      }
    }
  </div>

  <button
    type="submit"
    [disabled]="!passwordForm.valid || isLoading()"
    class="border-(--accent)! w-56 enabled:hover:text-(--accent)! border-2! enabled:hover:bg-transparent! rounded-lg! px-4! py-2! disabled:opacity-50! disabled:cursor-not-allowed! transition-all! bg-accent! text-white! font-medium!"
  >
    Save
  </button>
</form>
